<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shotcut icon" href="../../../../../Documentação/Logos/favicon.png" >
    <title>Beststreaming</title>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="assets/materialize/css/materialize.min.css" media="screen,projection" />
    <link rel="apple-touch-icon" sizes="57x57" href="../../Images/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="../../Images/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../../Images/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../../Images/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../../Images/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../../Images/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="../../Images/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="../../Images/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../../Images/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="../../Images/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../Images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../../Images/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../Images/favicon/favicon-16x16.png">
    <!-- Bootstrap Styles-->
    <link href="assets/css/bootstrap.css" rel="stylesheet" />
    <!-- FontAwesome Styles-->
    <link href="assets/css/font-awesome.css" rel="stylesheet" />
    <!-- Morris Chart Styles-->
    <link href="assets/js/morris/morris-0.4.3.min.css" rel="stylesheet" />
    <!-- Custom Styles-->
    <link href="assets/css/custom-styles.css" rel="stylesheet" />
    <!-- Google Fonts-->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />
    <link rel="stylesheet" href="assets/js/Lightweight-Chart/cssCharts.css">
</head>

<body onload="pegarDados()">
    <div id="wrapper">
        <nav class="navbar navbar-default top-navbar" role="navigation" style="margin-top: -10px;">
			<div class="navbar-header">
				<Img src="../images/bs.png" style="width: 150px;"></Img>

				<div class="botoes">
						<a href="index.html"><div class="bt1"><i class="fa fa-user fa-fw"></i>Dashboard</div></a>
					<a href="https://bandteccom.sharepoint.com/:u:/s/BStreaming/EUUWCafuNXhNt0PTVThKIHEBrUYI9m871Gz3X4EsTh_3kw?e=mEf0Vb"><div class="bt2"><i class="fa fa-user fa-fw" style="text-align: center;"></i>Mais detalhes</div></a>
				</div>


			</div>

			<ul class="nav navbar-top-links navbar-right" style="background:#fdcc34;">

				<li><a class="dropdown-button waves-effect waves-dark text-white" href="#!" data-activates="dropdown1">
					<i class="fa fa-user fa-fw text-white"></i> <b id="nomeUsuario">Usuário</b> 
					<i class="material-icons right">arrow_drop_down</i></a></li>
			</ul>
		</nav>
        <!-- Dropdown Structure -->
        <ul id="dropdown1" class="dropdown-content">
            <li><a href="perfil.html"><i class="fa fa-user fa-fw"></i> Perfil</a>
            </li>
            <li><a onclick="logout()"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
            </li>
        </ul>

        <!--/. NAV TOP  -->
    
        <!-- /. NAV SIDE  -->
       
            <div id="page-inner">

                <div class="row"  style="margin-top: 100px;">

                    <div class="col-md-12">
                        <div class="card">
                            <div class="cadastro">

                                <form id='form_atualizar' style="background:#320072 ;">
                                    <!-- <input type='hidden' value='' name='iduser' id='iduser'> -->
                                    <div class="form-row">
                                        <div class="form-group col-md-6" style="margin-top: 2%">
                                            <label for="nome">Nome</label>
                                            <input type="text" class="form-control" id="nome" name='nome'
                                                placeholder="..." >
                                        </div>
                                        <div class="form-group col-md-6"style="margin-top: 2%">
                                            <label for="cpf">CPF</label>
                                            <input type="number" class="form-control" id="cpf" name='cpf'
                                                placeholder="..." readonly>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                            <div class="form-group col-md-6">
                                                    <label for="telefone">Telefone</label>
                                                    <input type="number" class="form-control" id="telefone" name='tel'
                                                        placeholder="...">
                                                </div>
                                                <div class="form-group col-md-6">
                                                        <label for="email">Email</label>
                                                        <input type="email" class="form-control" id="email" name='email'
                                                            placeholder="...">
                                                    </div>
                                    </div>
                                    <div class="form-row">
                                            <div class="form-group col-md-6">
                                                    <label for="senha">Nova senha</label>
                                                    <input type="password" class="form-control" id="senha" name='senha'
                                                        placeholder="" required>
                                                </div>
                                        <div class="form-group col-md-6">
                                            <label for="confsenha">Confirmar senha</label>
                                            <input type="password" class="form-control" id="confsenha" name='confsenha'
                                                placeholder="" required>
                                        </div>
                                    </div>
                                    <div  class="form-row">
                                    <div class="form-group col-md-6">
                                        <label for="rua">Logradouro</label>
                                        <input type="text" class="form-control" id="rua" name='rua'
                                            placeholder="...">
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label for="numero" style="margin-right: 92.5%">Número</label>
                                        <input type="text" class="form-control" id="numero" name="numero"
                                            placeholder="...">
                                    </div>
                                </div>
                                <div  class="form-row">
                                        <div class="form-group col-md-6">
                                            <label for="complemento">Complemento</label>
                                            <input type="text" class="form-control" id="complemento" name='complemento'
                                                placeholder="...">
                                        </div>
                                        <div class="form-group col-md-6">
                                            <label for="bairro" style="margin-right: 92.5%">Bairro</label>
                                            <input type="text" class="form-control" id="bairro" name="bairro"
                                                placeholder="...">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group col-md-6">
                                            <label for="cidade">Cidade</label>
                                            <input type="text" class="form-control" id="cidade" name='cidade'>
                                        </div>
                                        <div class="form-group col-md-4">
                                            <label for="uf">Estado</label>
                                            <select id="uf" name='uf' class="form-control" style="margin-top: 3%">
                                                <option selected>Escolher...</option>
                                                <option value='AC'>AC</option>
                                                <option value='AL'>AL</option>
                                                <option value='AM'>AM</option>
                                                <option value='AP'>AP</option>
                                                <option value='BA'>BA</option>
                                                <option value='CE'>CE</option>
                                                <option value='DF'>DF</option>
                                                <option value='ES'>ES</option>
                                                <option value='GO'>GO</option>
                                                <option value='MA'>MA</option>
                                                <option value='MG'>MG</option>
                                                <option value='MT'>MT</option>
                                                <option value='MG'>MS</option>
                                                <option value='PA'>PA</option>
                                                <option value='PB'>PB</option>
                                                <option value='PE'>PE</option>
                                                <option value='PI'>PI</option>
                                                <option value='PR'>PR</option>
                                                <option value='RJ'>RJ</option>
                                                <option value='RN'>RN</option>
                                                <option value='RO'>RO</option>
                                                <option value='RR'>RR</option>
                                                <option value='RS'>RS</option>
                                                <option value='SC'>SC</option>
                                                <option value='SE'>SE</option>
                                                <option value='SP'>SP</option>
                                                <option value='TO'>TO</option>
                                            </select>
                                        </div>
                                        <div class="form-group col-md-2">
                                            <label for="cep">CEP</label>
                                            <input type="number" class="form-control" id="cep" name='cep'
                                            placeholder="...">
                                        </div>
                                    </div>
                                    <center><button type="button" onclick="atualizarCadastro(nome.value,email.value,
                                        cpf.value,telefone.value,senha.value,confsenha.value,
                                         cep.value,rua.value,numero.value,complemento.value,
                                         bairro.value,cidade.value,uf.value)" class="btn btn-primary"
                                            style="background-color:#fdcc34;border-color:#fdcc34; margin-bottom: 2%">Atualizar dados</button>
                                    </center>
                                </form>
                            </div>


                        </div>

                    </div>
                    <!-- /. PAGE INNER  -->
                </div>
                <!-- /. PAGE WRAPPER  -->
            </div>
            <!-- /. PAGE INNER  -->
        </div>
        <!-- /. PAGE WRAPPER  -->
        <!-- /. WRAPPER  -->
        <!-- JS Scripts-->


        <!-- jQuery Js -->
        <script src="assets/js/jquery-1.10.2.js"></script>

        <!-- Bootstrap Js -->
        <script src="assets/js/bootstrap.min.js"></script>

        <script src="assets/materialize/js/materialize.min.js"></script>

        <!-- Metis Menu Js -->
        <script src="assets/js/jquery.metisMenu.js"></script>
        <!-- Morris Chart Js -->
        <script src="assets/js/morris/raphael-2.1.0.min.js"></script>
        <script src="assets/js/morris/morris.js"></script>


        <script src="assets/js/easypiechart.js"></script>
        <script src="assets/js/easypiechart-data.js"></script>

        <script src="assets/js/Lightweight-Chart/jquery.chart.js"></script>
        <!-- DATA TABLE SCRIPTS -->
        <script src="assets/js/dataTables/jquery.dataTables.js"></script>
        <script src="assets/js/dataTables/dataTables.bootstrap.js"></script>
        <script>
            $(document).ready(function () {
                $('#dataTables-example').dataTable();
            });
        </script>
        <!-- Custom Js -->
        <script src="assets/js/custom-scripts.js"></script>


</body>

</html>

<script type="text/javascript" src="../js/auth.js"></script>
<script type="text/javascript">
verificarSessao();
let nome = sessionStorage.getItem("nomeUsuario").split(" ");
document.getElementById("nomeUsuario").innerHTML = nome[0];

const id = sessionStorage.getItem("id");

function pegarDados(){
    let URL = `https://backend-nextstreaming.azurewebsites.net/api/streamer/${id}`;
    var xhttp = new XMLHttpRequest();

    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            resposta = JSON.parse(xhttp.responseText);

            document.getElementById("nome").value = resposta.data[0].nome
            document.getElementById("cpf").value = resposta.data[0].cpf
            document.getElementById("telefone").value = resposta.data[0].telefone
            document.getElementById("email").value = resposta.data[0].email
            document.getElementById("rua").value = resposta.data[0].endereco[0].logradouro
            document.getElementById("numero").value = resposta.data[0].endereco[0].numero
            document.getElementById("complemento").value = resposta.data[0].endereco[0].complemento
            document.getElementById("bairro").value = resposta.data[0].endereco[0].bairro
            document.getElementById("cidade").value = resposta.data[0].endereco[0].cidade
            document.getElementById("uf").value = resposta.data[0].endereco[0].uf
            document.getElementById("cep").value = resposta.data[0].endereco[0].cep        
        }   
    };

    xhttp.open("GET", URL , true);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xhttp.send();
}

function atualizarCadastro(nome,email,cpf,telefone,senha,confsenha,
  cep,rua,numero,complemento,bairro,cidade,uf){

  const data = {
    nome: nome,
    email: email,
    cpf: cpf,
    telefone: telefone,
    senha: senha, confsenha: confsenha,
    cep: cep, 
    rua: rua,
    numero: numero,
    complemento: complemento,
    bairro: bairro,
    cidade: cidade,
    uf: uf
  }
  const json = JSON.stringify(data);

  let URL = `https://backend-nextstreaming.azurewebsites.net/api/streamer/${id}`;
  var xhttp = new XMLHttpRequest();

  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        resposta = JSON.parse(xhttp.responseText);

      if(resposta.result==true){
        alert("Atualizado com sucesso")
        sessionStorage.removeItem("nomeUsuario");
        sessionStorage.setItem("nomeUsuario", resposta.data[0].nome);     
        window.location.reload(true);
      }else{
        alert(resposta.message);
      }
    }
};
xhttp.open("PUT", URL , true);
xhttp.setRequestHeader("Content-type", "application/json; charset=utf-8");
xhttp.send(json);
}
</script>
